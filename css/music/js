// Función para ajustar el volumen gradualmente
function fadeVolume(direction, duration = 2000) {
    const music = document.getElementById('backgroundMusic');
    const steps = 20;
    const stepTime = duration / steps;
    const volumeStep = direction === 'in' ? 0.5 / steps : -0.5 / steps;
    
    let currentStep = 0;
    
    const fadeInterval = setInterval(() => {
        currentStep++;
        music.volume = Math.max(0, Math.min(1, music.volume + volumeStep));
        
        if (currentStep >= steps) {
            clearInterval(fadeInterval);
        }
    }, stepTime);
}

// Función para iniciar la música con fade in
function startMusicWithFade() {
    const music = document.getElementById('backgroundMusic');
    music.volume = 0;
    music.play();
    fadeVolume('in');
}

// Función para pausar la música con fade out
function stopMusicWithFade() {
    fadeVolume('out');
    setTimeout(() => {
        document.getElementById('backgroundMusic').pause();
    }, 2000);
}

// Evento para cuando la página pierde el foco
document.addEventListener('visibilitychange', () => {
    if (document.hidden) {
        fadeVolume('out');
    } else {
        fadeVolume('in');
    }
});
